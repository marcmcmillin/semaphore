---
- name: View Containers in All Docker Networks
  hosts: your_docker_hosts  # Replace with your Docker host group
  collections:
    - community.docker
  gather_facts: false
  tasks:
    - name: Get all Docker networks
      community.docker.docker_network_info:
        all: yes
      register: docker_networks

    - name: List containers in each network
      debug:
        msg: "Network: {{ item.name }}"
      loop: "{{ docker_networks.networks }}"

    - name: Get container details for each network
      community.docker.docker_network_info:
        name: "{{ item.name }}"
      register: network_info
      loop: "{{ docker_networks.networks }}"

    - name: Display containers in each network
      debug:
        msg: "  Containers: {{ network_info.results[loop.index].network.Containers | dict2items }}"
      loop: "{{ docker_networks.networks }}"
      when: network_info.results[loop.index].network.Containers is defined and network_info.results[loop.index].network.Containers | length > 0
